<!DOCTYPE html>
<html>
<head>
    <title>D3.js Poster</title>
    <style>
    .poster-background {
        background-image: url('image1.png');
        background-size: cover; /* or contain, depending on how you want the image to be scaled */
        /* Add any other background properties you want, e.g., background-repeat, background-position, etc. */
      }
      body {
      font-family: 'Noto Sans Gujarati', sans-serif;
    }

 /* Center the modal vertically and horizontally */
.modal {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Set fixed dimensions for the modal */
.modal-dialog {
    width: 500px; /* Adjust the width as per your preference */
    height: 400px; /* Adjust the height as per your preference */
}

/* Style the modal body content */
.modal-body {
    padding: 20px;
}

/* Style the poster container to make it fit inside the modal */
#poster-container {
    width: 100%;
    height: 100%;
}

/* Style the SVG to cover the entire container while maintaining aspect ratio */
#poster-container svg {
    width: 100%;
    height: 100%;
    object-fit: contain;
}



    </style>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Gujarati:wght@400;700&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    

    <!-- Multiple divs to display posters -->
    <div class="poster-item">
        <h1>જય સ્વામીનારાયણ </h1>
        <button class="btn btn-primary" onclick="openModal('જય સ્વામીનારાયણ')">Open Modal</button>
    </div>

    <div class="poster-item">
        <h1>Name 2</h1>
        <button class="btn btn-primary" onclick="openModal('Name 2')">Open Modal</button>
    </div>

    <!-- Modal -->
    <div id="myModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Poster</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="poster-container">
                        <!-- The SVG content will be generated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="exportToPNG()">Export as PNG</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <script>
        var svgContainer = d3.select("#poster-container");
        var textInput;

        function createPoster(name) {
            var posterWidth = 1081;
            var posterHeight = 1920;

            // Remove the previous SVG if it exists
            svgContainer.selectAll("*").remove();

            var svg = svgContainer
                .append("svg")
                // .attr("class", "poster-svg")
                .attr("class", "poster-svg poster-background")
                .attr("width", posterWidth)
                .attr("height", posterHeight);

            // Add the text on top of the image
            svg.append("text")
                .attr("x", posterWidth / 2)
                .attr("y", posterHeight / 2)
                .attr("text-anchor", "middle")
                .attr("alignment-baseline", "middle")
                .attr("fill", "white")
                .attr("font-size", "24")
                .text(name);

            textInput = name;
        }

        function openModal(name) {
            createPoster(name);
            $('#myModal').modal('show');
        }

        function closeModal() {
            $('#myModal').modal('hide');
        }

        function exportToPNG() {
            var container = document.getElementById("poster-container");
            domtoimage.toPng(container)
                .then(function (dataUrl) {
                    var link = document.createElement("a");
                    link.download = textInput + "_poster.png";
                    link.href = dataUrl;
                    link.click();
                    closeModal(); // Close the modal after exporting
                })
                .catch(function (error) {
                    console.error("Error exporting poster to PNG:", error);
                });
        }
    </script>
</body>
</html>
