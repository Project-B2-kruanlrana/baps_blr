<!DOCTYPE html>
<html>
<head>
    <title>Baps BLR | DAILY POSTER</title>
    <script src="service-worker.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Akshar:wght@500&family=Noto+Serif+Gujarati:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
    /* @font-face {
        font-family: '';
        src: url();
    } */
    /* <style> */
    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Gujarati:wght@700&display=swap');

    .poster-background {
        background-image: url('Self1.png');
        background-size: cover; /* or contain, depending on how you want the image to be scaled */
        /* Add any other background properties you want, e.g., background-repeat, background-position, etc. */
      }
      body {
        /* font-family: 'Akshar', sans-serif;
        font-family: 'Noto Sans Gujarati', sans-serif; */
        font-family: 'Noto Sans Gujarati', sans-serif;

        /* font-family: 'Akshar', sans-serif; */
      /* font-family: 'Noto Sans Gujarati', sans-serif; */
    }

 /* Center the modal vertically and horizontally */
.modal {
    display: flex;
    align-items: center;
    justify-content: center;
}

/* Set fixed dimensions for the modal */
.modal-dialog {
    width: 500px; /* Adjust the width as per your preference */
    height: 400px; /* Adjust the height as per your preference */
}

/* Style the modal body content */
.modal-body {
    padding: 20px;
}

/* Style the poster container to make it fit inside the modal */
#poster-container {
    width: 100%;
    height: 100%;
}

/* Style the SVG to cover the entire container while maintaining aspect ratio */
#poster-container svg {
    width: 100%;
    height: 100%;
    object-fit: contain;
}



    </style>
    
    <!-- <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Gujarati:wght@400;700&display=swap" rel="stylesheet"> -->
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    

    <!-- Multiple divs to display posters -->
    <div class="poster-item">
        <h1>નીરંજન વાસ </h1>
        <button class="btn btn-primary" onclick="openModal('નીરંજન વાસ','વાસ')">Open Modal</button>
    </div>

    <div class="poster-item">
        <h1>કુનાલભાઈ જૈન</h1>
        <button class="btn btn-primary" onclick="openModal('કુનાલભાઈ જૈન','જૈન')">Open Modal</button>
    </div>

     <div class="poster-item">
        <h1>દીપરામજી </h1>
        <button class="btn btn-primary" onclick="openModal('દીપરામજી ',' ')">Open Modal</button>
    </div>
     <div class="poster-item">
        <h1>મૌલિકભાઈ પૂજાર</h1>
        <button class="btn btn-primary" onclick="openModal('મૌલિકભાઈ પૂજાર','પૂજાર')">Open Modal</button>
    </div>
    

    <!-- Modal -->
    <div id="myModal" class="modal" tabindex="-1" role="dialog">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Poster</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <div id="poster-container">
                        <!-- The SVG content will be generated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="exportToPNG()">Export as PNG</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
    <script>
        var svgContainer = d3.select("#poster-container");
        var textInput;
        function createPoster(name,surname) {
            var finalsurname=""
            // Check if surname is defined and not empty
            if (surname) {
             finalsurname = "તથા સમસ્ત " + surname + " પરિવારને";
            } else {
             finalsurname = " ";
            }

            var longText ="પ.ભ."+name
            var longText2=" તથા સમસ્ત "+finalsurname+" પરિવારને"
            var longText3=" સસ્નેહપુર્વકના જય શ્રી સ્વામિનારાયણ"
            var posterWidth = 1081;
            var posterHeight = 1920;

            // Remove the previous SVG if it exists
            svgContainer.selectAll("*").remove();

            var svg = svgContainer
                .append("svg")
                // .attr("class", "poster-svg")
                .attr("class", "poster-svg poster-background")
                .attr("width", posterWidth)
                .attr("height", posterHeight);

            svg.append("text")
                .attr("x", "50%") 
                .attr("y", "31%")
                .attr("text-anchor", "middle")
                .attr("alignment-baseline", "middle")
                .attr("font-family", "'Noto Sans Gujarati', sans-serif")
                .attr("fill", "#63251a")
                .attr("font-size", "19")
                .attr("font-weight", "700") 
                .text(longText)
                .attr("font-family", "'Noto Sans Gujarati', sans-serif")
                .append("tspan")
                .attr("x", "50%")
                .attr("dy", "1.7em")
                .text(longText2)
                .attr("font-family", "'Noto Sans Gujarati', sans-serif")
                .append("tspan")
                .attr("x", "50%")
                .attr("dy", "1.7em")
                .text(longText3);
                
                textInput = longText+longText2+longText3;
        }
    
        function openModal(name) {
            createPoster(name);
            $('#myModal').modal('show');
        }

        function closeModal() {
            $('#myModal').modal('hide');
        }

        function exportToPNG() {
            var container = document.getElementById("poster-container");
            domtoimage.toPng(container)
                .then(function (dataUrl) {
                    var link = document.createElement("a");
                    link.download = textInput + "_poster.png";
                    link.href = dataUrl;
                    link.click();
                    closeModal(); // Close the modal after exporting
                })
                .catch(function (error) {
                    console.error("Error exporting poster to PNG:", error);
                });
        }
    </script>
<!--     adding Register the service worker: To enable caching and offline functionality, you need to register a service worker. Add the following script at the end of your <body> tag in your HTML file:  -->
    <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => {
          console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch(error => {
          console.error('Service Worker registration failed:', error);
        });
    });
  }
</script>

</body>
</html>
